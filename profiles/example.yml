main:
  - name: infra
    dir: server/infra
    steps: 
      - cmd: gg build-templates .
        desc: building templates for infra
      - cmd: ./infra_deploy_if_needed.sh
        dir: gcp # infers ./server/infra/gcp based on top level dir
        desc: deploying infra if needed
  - name: setup-ip
    steps:
      - cmd: gg update-profile server.host $(./server/infra/get_ip.sh)
        desc: updates IP address on current profile
  - name: game-client
    dir: game
    steps: 
      - cmd: gg build-templates .
        desc: building game templates
      - cmd: ./build_clients.sh
        desc: building game clients
      - cmd: ./deploy_clients.sh
        desc: deploying game clients
  - name: nakama-server
    dir: server
    steps: 
      - cmd: gg build-templates .
        desc: building server templates
      - cmd: ./build_server.sh
        desc: building server
      - cmd: ./deploy/gcp/deploy.sh
        desc: deploying to GCP


tasks:
  - name: destroy-infra
    cmd: ./destroy_infra.sh
    dir: server/infra



## TPL stuff to remove?

# gcloud:
#   project: projectname
#   region: us-east1
#   cloudZone: us-east1-b
#

server:
  host: 127.0.0.1
  port: 7350
  secure: false

game:
  real_world_seconds_per_day: 12 * 60
  version: 0.1.23
